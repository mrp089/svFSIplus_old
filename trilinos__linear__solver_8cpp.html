<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>svFSIplus: svFSI/trilinos_linear_solver.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">svFSIplus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3f51565a9652c679f048fd51d3fd35a5.html">svFSI</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">trilinos_linear_solver.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>wrap <a class="el" href="struct_trilinos.html" title="Initialize all Epetra types we need separate from Fortran.">Trilinos</a> solver functions  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="trilinos__linear__solver_8h_source.html">trilinos_linear_solver.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for trilinos_linear_solver.cpp:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 0 -->
</div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a06b2f8de3c282e6fe98f9d768e86778c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#a06b2f8de3c282e6fe98f9d768e86778c">trilinos_lhs_create_</a> (int &amp;numGlobalNodes, int &amp;numLocalNodes, int &amp;numGhostAndLocalNodes, int &amp;nnz, const int *ltgSorted, const int *ltgUnsorted, const int *rowPtr, const int *colInd, int &amp;Dof, int &amp;cpp_index, int &amp;proc_id)</td></tr>
<tr class="memdesc:a06b2f8de3c282e6fe98f9d768e86778c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Give function definitions which will be called through fortran.  <a href="trilinos__linear__solver_8cpp.html#a06b2f8de3c282e6fe98f9d768e86778c">More...</a><br /></td></tr>
<tr class="separator:a06b2f8de3c282e6fe98f9d768e86778c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25504d623105f5c9a0b829d2baa1fa95"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#a25504d623105f5c9a0b829d2baa1fa95">trilinos_doassem_</a> (int &amp;numNodesPerElement, const int *eqN, const double *lK, double *lR)</td></tr>
<tr class="separator:a25504d623105f5c9a0b829d2baa1fa95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01a7534101b99e4a65c1798d218b8e11"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#a01a7534101b99e4a65c1798d218b8e11">trilinos_global_solve_</a> (const double *Val, const double *RHS, double *x, const double *dirW, double &amp;resNorm, double &amp;initNorm, int &amp;numIters, double &amp;solverTime, double &amp;dB, bool &amp;converged, int &amp;<a class="el" href="classls_type.html">lsType</a>, double &amp;relTol, int &amp;maxIters, int &amp;kspace, int &amp;precondType)</td></tr>
<tr class="separator:a01a7534101b99e4a65c1798d218b8e11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a5f9b39b44fc9e3b47a7777ca7dcd4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#a5a5f9b39b44fc9e3b47a7777ca7dcd4c">trilinos_solve_</a> (double *x, const double *dirW, double &amp;resNorm, double &amp;initNorm, int &amp;numIters, double &amp;solverTime, double &amp;dB, bool &amp;converged, int &amp;<a class="el" href="classls_type.html">lsType</a>, double &amp;relTol, int &amp;maxIters, int &amp;kspace, int &amp;precondType, bool &amp;isFassem)</td></tr>
<tr class="separator:a5a5f9b39b44fc9e3b47a7777ca7dcd4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a026d29a16fe6ff36f0878bb1d4ac0943"><td class="memItemLeft" align="right" valign="top"><a id="a026d29a16fe6ff36f0878bb1d4ac0943"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setPreconditioner</b> (int precondType, AztecOO &amp;Solver)</td></tr>
<tr class="separator:a026d29a16fe6ff36f0878bb1d4ac0943"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac4e278f557d71ee0456e129265f990"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#aeac4e278f557d71ee0456e129265f990">setMLPrec</a> (AztecOO &amp;Solver)</td></tr>
<tr class="separator:aeac4e278f557d71ee0456e129265f990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42ce145a97bc64f2bcf4096e1b5c14cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#a42ce145a97bc64f2bcf4096e1b5c14cc">setIFPACKPrec</a> (AztecOO &amp;Solver)</td></tr>
<tr class="separator:a42ce145a97bc64f2bcf4096e1b5c14cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0dba28d93cc1e01d1ea1a684c13a562"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#af0dba28d93cc1e01d1ea1a684c13a562">checkDiagonalIsZero</a> ()</td></tr>
<tr class="separator:af0dba28d93cc1e01d1ea1a684c13a562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09e16bab54fa3b873598cc94266730fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#a09e16bab54fa3b873598cc94266730fc">constructJacobiScaling</a> (const double *dirW, Epetra_Vector &amp;diagonal)</td></tr>
<tr class="separator:a09e16bab54fa3b873598cc94266730fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae64c85dd19a577bf6bda6af306081ef0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#ae64c85dd19a577bf6bda6af306081ef0">trilinos_bc_create_</a> (const double *v, bool &amp;isCoupledBC)</td></tr>
<tr class="separator:ae64c85dd19a577bf6bda6af306081ef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a027fc4d183f23fe170a241f083ded386"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#a027fc4d183f23fe170a241f083ded386">trilinos_lhs_free_</a> ()</td></tr>
<tr class="separator:a027fc4d183f23fe170a241f083ded386"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f66c043527fdb7e7ebb18c0aaabc95d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#a9f66c043527fdb7e7ebb18c0aaabc95d">printMatrixToFile</a> ()</td></tr>
<tr class="separator:a9f66c043527fdb7e7ebb18c0aaabc95d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe8d0285425f436b1d65174736d497f9"><td class="memItemLeft" align="right" valign="top"><a id="abe8d0285425f436b1d65174736d497f9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>printRHSToFile</b> ()</td></tr>
<tr class="separator:abe8d0285425f436b1d65174736d497f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac040874eb33694222b94b02929b5f477"><td class="memItemLeft" align="right" valign="top"><a id="ac040874eb33694222b94b02929b5f477"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>printSolutionToFile</b> ()</td></tr>
<tr class="separator:ac040874eb33694222b94b02929b5f477"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9ade2bc502952e3df08bb4d0cb56c74a"><td class="memItemLeft" align="right" valign="top"><a id="a9ade2bc502952e3df08bb4d0cb56c74a"></a>
ML_Epetra::MultiLevelPreconditioner *&#160;</td><td class="memItemRight" valign="bottom"><b>MLPrec</b> = NULL</td></tr>
<tr class="separator:a9ade2bc502952e3df08bb4d0cb56c74a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8503f1ccbded772a7f984d52accb2fc4"><td class="memItemLeft" align="right" valign="top"><a id="a8503f1ccbded772a7f984d52accb2fc4"></a>
Ifpack_Preconditioner *&#160;</td><td class="memItemRight" valign="bottom"><b>ifpackPrec</b> = NULL</td></tr>
<tr class="separator:a8503f1ccbded772a7f984d52accb2fc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03745287ca42590ead4a18807041fc66"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#a03745287ca42590ead4a18807041fc66">dof</a></td></tr>
<tr class="memdesc:a03745287ca42590ead4a18807041fc66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nodal degrees of freedom.  <a href="trilinos__linear__solver_8cpp.html#a03745287ca42590ead4a18807041fc66">More...</a><br /></td></tr>
<tr class="separator:a03745287ca42590ead4a18807041fc66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a782d8faac6ba1ef6989675b3eb9bc622"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#a782d8faac6ba1ef6989675b3eb9bc622">ghostAndLocalNodes</a></td></tr>
<tr class="memdesc:a782d8faac6ba1ef6989675b3eb9bc622"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of nodes including the ghost nodes.  <a href="trilinos__linear__solver_8cpp.html#a782d8faac6ba1ef6989675b3eb9bc622">More...</a><br /></td></tr>
<tr class="separator:a782d8faac6ba1ef6989675b3eb9bc622"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5070d59530e329af740da833e3e928c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#aa5070d59530e329af740da833e3e928c">localNodes</a></td></tr>
<tr class="memdesc:aa5070d59530e329af740da833e3e928c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nodes owned by processor.  <a href="trilinos__linear__solver_8cpp.html#aa5070d59530e329af740da833e3e928c">More...</a><br /></td></tr>
<tr class="separator:aa5070d59530e329af740da833e3e928c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a8eb0e0ab914a10b815927ce257c5bb"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#a3a8eb0e0ab914a10b815927ce257c5bb">globalColInd</a></td></tr>
<tr class="memdesc:a3a8eb0e0ab914a10b815927ce257c5bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts local proc column indices to global indices to be inserted.  <a href="trilinos__linear__solver_8cpp.html#a3a8eb0e0ab914a10b815927ce257c5bb">More...</a><br /></td></tr>
<tr class="separator:a3a8eb0e0ab914a10b815927ce257c5bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a581ab3505650753692a1cbdf9b911fe6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#a581ab3505650753692a1cbdf9b911fe6">localToGlobalUnsorted</a></td></tr>
<tr class="memdesc:a581ab3505650753692a1cbdf9b911fe6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts local indices to global indices in unsorted ghost node order.  <a href="trilinos__linear__solver_8cpp.html#a581ab3505650753692a1cbdf9b911fe6">More...</a><br /></td></tr>
<tr class="separator:a581ab3505650753692a1cbdf9b911fe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeba001f773ee14be085255bd0c1ade18"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trilinos__linear__solver_8cpp.html#aeba001f773ee14be085255bd0c1ade18">nnzPerRow</a></td></tr>
<tr class="memdesc:aeba001f773ee14be085255bd0c1ade18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores number of nonzeros per row for the topology.  <a href="trilinos__linear__solver_8cpp.html#aeba001f773ee14be085255bd0c1ade18">More...</a><br /></td></tr>
<tr class="separator:aeba001f773ee14be085255bd0c1ade18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b055135141eb148021088dc82af3d4f"><td class="memItemLeft" align="right" valign="top"><a id="a9b055135141eb148021088dc82af3d4f"></a>
std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>localToGlobalSorted</b></td></tr>
<tr class="separator:a9b055135141eb148021088dc82af3d4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d6b5ec16ddbf1ae86df1b67b1d8798"><td class="memItemLeft" align="right" valign="top"><a id="a56d6b5ec16ddbf1ae86df1b67b1d8798"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>timecount</b> = 0</td></tr>
<tr class="separator:a56d6b5ec16ddbf1ae86df1b67b1d8798"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a100576521b952dc6c5e7125d686c12d3"><td class="memItemLeft" align="right" valign="top"><a id="a100576521b952dc6c5e7125d686c12d3"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>coupledBC</b></td></tr>
<tr class="separator:a100576521b952dc6c5e7125d686c12d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>wrap <a class="el" href="struct_trilinos.html" title="Initialize all Epetra types we need separate from Fortran.">Trilinos</a> solver functions </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af0dba28d93cc1e01d1ea1a684c13a562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0dba28d93cc1e01d1ea1a684c13a562">&#9670;&nbsp;</a></span>checkDiagonalIsZero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void checkDiagonalIsZero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine is to be used with preconditioners such as ILUT which require 1s on the diagonal </p>

</div>
</div>
<a id="a09e16bab54fa3b873598cc94266730fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09e16bab54fa3b873598cc94266730fc">&#9670;&nbsp;</a></span>constructJacobiScaling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void constructJacobiScaling </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>dirW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Epetra_Vector &amp;&#160;</td>
          <td class="paramname"><em>diagonal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>To be called within solve-output diagonal from here</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dirW</td><td>pass in array with Dirichlet boundary face nodes marked \paramdiagonal diagonal scaling vector need to output to multiply solution by </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9f66c043527fdb7e7ebb18c0aaabc95d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f66c043527fdb7e7ebb18c0aaabc95d">&#9670;&nbsp;</a></span>printMatrixToFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void printMatrixToFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>for debugging purposes here are routines to print the matrix and RHS vector </p>

</div>
</div>
<a id="a42ce145a97bc64f2bcf4096e1b5c14cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42ce145a97bc64f2bcf4096e1b5c14cc">&#9670;&nbsp;</a></span>setIFPACKPrec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setIFPACKPrec </td>
          <td>(</td>
          <td class="paramtype">AztecOO &amp;&#160;</td>
          <td class="paramname"><em>Solver</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pass in IC, ICT pass in string for which to turn on right now set to IC </p>

</div>
</div>
<a id="aeac4e278f557d71ee0456e129265f990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeac4e278f557d71ee0456e129265f990">&#9670;&nbsp;</a></span>setMLPrec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setMLPrec </td>
          <td>(</td>
          <td class="paramtype">AztecOO &amp;&#160;</td>
          <td class="paramname"><em>Solver</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tune parameters for htis and IFPACK Ref: <a href="https://trilinos.org/oldsite/packages/ml/mlguide5.pdf">https://trilinos.org/oldsite/packages/ml/mlguide5.pdf</a> </p>

</div>
</div>
<a id="ae64c85dd19a577bf6bda6af306081ef0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae64c85dd19a577bf6bda6af306081ef0">&#9670;&nbsp;</a></span>trilinos_bc_create_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trilinos_bc_create_ </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>isCoupledBC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>coupled boundary vector </td></tr>
    <tr><td class="paramname">isCoupledBC</td><td>determines if coupled resistance BC is turned on </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a25504d623105f5c9a0b829d2baa1fa95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25504d623105f5c9a0b829d2baa1fa95">&#9670;&nbsp;</a></span>trilinos_doassem_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trilinos_doassem_ </td>
          <td>(</td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>numNodesPerElement</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>eqN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>lK</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lR</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function assembles the dense element block stiffness matrix and element block force vector into the global block stiffness K and global block force vector F. Happens on a single element and will be called repeatedly as we loop over all the elements.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">numNodesPerElement</td><td>number of nodes (d) for element e </td></tr>
    <tr><td class="paramname">eqN</td><td>converts local element node number to local proc equation number-size is numNodesPerElement </td></tr>
    <tr><td class="paramname">lK</td><td>element local stiffness of size (dof*dof, numNodesPerElement, numNodesPerElement) </td></tr>
    <tr><td class="paramname">lR</td><td>element local force vector of size (dof, numNodesPerElement) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a01a7534101b99e4a65c1798d218b8e11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01a7534101b99e4a65c1798d218b8e11">&#9670;&nbsp;</a></span>trilinos_global_solve_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trilinos_global_solve_ </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>Val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>RHS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>dirW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>resNorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>initNorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>numIters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>solverTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>dB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>converged</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>lsType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>relTol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>maxIters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>kspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>precondType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tthis function creates the LHS structure topology and RHS vector based on the block map using the global stiffness matrix and global force vector assuming the assembly part has been done in svFSI</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Val</td><td>nonzero values of assembled global stiffness </td></tr>
    <tr><td class="paramname">RHS</td><td>global force vector </td></tr>
    <tr><td class="paramname">x</td><td>solution vector </td></tr>
    <tr><td class="paramname">dirW</td><td>gives information about the Dirichlet BC </td></tr>
    <tr><td class="paramname">resNorm</td><td>norm of solution </td></tr>
    <tr><td class="paramname">initNorm</td><td>initial norm of RHS </td></tr>
    <tr><td class="paramname">numIters</td><td>linear solver number of iterations </td></tr>
    <tr><td class="paramname">solverTime</td><td>time in linear solver </td></tr>
    <tr><td class="paramname">dB</td><td>log ratio for output </td></tr>
    <tr><td class="paramname">converged</td><td>neither or not converged in the max number of iterations </td></tr>
    <tr><td class="paramname"><a class="el" href="classls_type.html" title="Linear system of equations solver type.">lsType</a></td><td>defines type of linear solver to use </td></tr>
    <tr><td class="paramname">relTol</td><td>default relative tolerance or as set in input file </td></tr>
    <tr><td class="paramname">maxIters</td><td>default max number of iterations for gmres per restart </td></tr>
    <tr><td class="paramname">kspace</td><td>specific for gmres dim of the stored Krylov space vectors </td></tr>
    <tr><td class="paramname">precondType</td><td>defines type of preconditioner to use </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a06b2f8de3c282e6fe98f9d768e86778c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06b2f8de3c282e6fe98f9d768e86778c">&#9670;&nbsp;</a></span>trilinos_lhs_create_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trilinos_lhs_create_ </td>
          <td>(</td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>numGlobalNodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>numLocalNodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>numGhostAndLocalNodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>ltgSorted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>ltgUnsorted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>rowPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>colInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>Dof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>cpp_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>proc_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Give function definitions which will be called through fortran. </p>
<p>make the graph global and optimize storage on it this function creates the LHS structure topology and RHS vector based on the block map </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">numGlobalNodes</td><td>total/global number of nodes each node can have dof for the spatial dim </td></tr>
    <tr><td class="paramname">numLocalNodes</td><td>number of nodes owned by this proc in block coordiantes </td></tr>
    <tr><td class="paramname">numGhostAndLocalNodes</td><td>number of nodes owned and shared by this processor includes ghost nodes </td></tr>
    <tr><td class="paramname">nnz</td><td>number of nonzeros in LHS matrix of calling proc </td></tr>
    <tr><td class="paramname">ltgSorted</td><td>integer pointer of size numLocalNodes returns global node number of local node a to give blockrow </td></tr>
    <tr><td class="paramname">ltgUnsorted</td><td>unsorted/not-reordered version </td></tr>
    <tr><td class="paramname">rowPtr</td><td>CSR row ptr of size numLocalNodes + 1 to block rows </td></tr>
    <tr><td class="paramname">colInd</td><td>CSR column indices ptr (size nnz points) to block rows </td></tr>
    <tr><td class="paramname">Dof</td><td>size of each block element to give dim of each block </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a027fc4d183f23fe170a241f083ded386"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a027fc4d183f23fe170a241f083ded386">&#9670;&nbsp;</a></span>trilinos_lhs_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trilinos_lhs_free_ </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>free the memory of the global data structures </p>

</div>
</div>
<a id="a5a5f9b39b44fc9e3b47a7777ca7dcd4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a5f9b39b44fc9e3b47a7777ca7dcd4c">&#9670;&nbsp;</a></span>trilinos_solve_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trilinos_solve_ </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>dirW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>resNorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>initNorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>numIters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>solverTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>dB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>converged</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>lsType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>relTol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>maxIters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>kspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>precondType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>isFassem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function uses the established data structure to solve the block linear system and passes the solution vector back to fortran with the ghost nodes filled in</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>solution vector </td></tr>
    <tr><td class="paramname">dirW</td><td>gives information about Dirichlet BC </td></tr>
    <tr><td class="paramname">resNorm</td><td>norm of the final residual </td></tr>
    <tr><td class="paramname">initNorm</td><td>norm of initial resiual x_init = 0 ||b|| </td></tr>
    <tr><td class="paramname">numIters</td><td>number of iterations in the linear solver </td></tr>
    <tr><td class="paramname">solverTime</td><td>time in the linear solver </td></tr>
    <tr><td class="paramname">dB</td><td>log ratio for output </td></tr>
    <tr><td class="paramname">converged</td><td>can pass in solver and preconditioner type too </td></tr>
    <tr><td class="paramname"><a class="el" href="classls_type.html" title="Linear system of equations solver type.">lsType</a></td><td>defines type of linear solver to use </td></tr>
    <tr><td class="paramname">relTol</td><td>default relative tolerance or as set in input file </td></tr>
    <tr><td class="paramname">maxIters</td><td>default max number of iterations for gmres per restart </td></tr>
    <tr><td class="paramname">kspace</td><td>specific for gmres dim of the stored Krylov space vectors </td></tr>
    <tr><td class="paramname">precondType</td><td>defines type of preconditioner to use </td></tr>
    <tr><td class="paramname">isFassem</td><td>determines if F is already assembled at ghost nodes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a03745287ca42590ead4a18807041fc66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03745287ca42590ead4a18807041fc66">&#9670;&nbsp;</a></span>dof</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dof</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Nodal degrees of freedom. </p>

</div>
</div>
<a id="a782d8faac6ba1ef6989675b3eb9bc622"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a782d8faac6ba1ef6989675b3eb9bc622">&#9670;&nbsp;</a></span>ghostAndLocalNodes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ghostAndLocalNodes</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Total number of nodes including the ghost nodes. </p>

</div>
</div>
<a id="a3a8eb0e0ab914a10b815927ce257c5bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a8eb0e0ab914a10b815927ce257c5bb">&#9670;&nbsp;</a></span>globalColInd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; globalColInd</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts local proc column indices to global indices to be inserted. </p>

</div>
</div>
<a id="aa5070d59530e329af740da833e3e928c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5070d59530e329af740da833e3e928c">&#9670;&nbsp;</a></span>localNodes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int localNodes</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Nodes owned by processor. </p>

</div>
</div>
<a id="a581ab3505650753692a1cbdf9b911fe6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a581ab3505650753692a1cbdf9b911fe6">&#9670;&nbsp;</a></span>localToGlobalUnsorted</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; localToGlobalUnsorted</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts local indices to global indices in unsorted ghost node order. </p>

</div>
</div>
<a id="aeba001f773ee14be085255bd0c1ade18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeba001f773ee14be085255bd0c1ade18">&#9670;&nbsp;</a></span>nnzPerRow</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; nnzPerRow</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stores number of nonzeros per row for the topology. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
